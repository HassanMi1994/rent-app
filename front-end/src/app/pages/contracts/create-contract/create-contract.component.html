<form name="create-contract-form">
    <div class="row">
        <div class="col-12 text-center">
            <ng-select [items]="customers$ |async" [typeahead]="inputSearchCustomer$"
                [notFoundText]="'notFound'|transloco" class="text-center center" bindValue="this" bindLabel="fullName"
                [placeholder]="'customer'|transloco" autofocus default [(ngModel)]="contract.customer">
                <ng-template ng-option-tmp let-item="item" let-index="index">
                    <span class="col-6 p-3 text-start border-1 text-success">{{ item.fullName}}</span>
                </ng-template>
            </ng-select>
        </div>
    </div>


    <!-- Button trigger modal -->
    <button type="button" class="btn btn-outline-primary btn-lg col-12" data-bs-toggle="modal"
        data-bs-target="#modalId">
        {{'selectStuff'|transloco}}
    </button>

    <div class="row">
        <div class="contract-item-header row">
            <div class="col-3 h6 text-info text-center">
                {{'name'|transloco}}
            </div>

            <div class="col-3 h6 text-info text-center">
                {{'quantity'|transloco}}
            </div>


            <div class="col-3 h6 text-info text-center">
                {{'pricePerDay'|transloco}}
            </div>

        </div>

        @for (item of contract.contractStuffs; track $index) {

        <div class="contract-item row">
            <div class=" col-3 h6 text-center">
                {{item.stuffID}}
            </div>

            <div class="col-3 h6 text-center">
                {{item.quantity}}
            </div>

            <div class="col-3 h6 text-center">
                {{item.pricePerDay}}
            </div>

            <div class="col-3 p-2 h6 text-info text-center">
                <a [routerLink]="" class="col-4 text-center" (click)="deleteItem($event)">
                    <span class="bi bi-eraser-fill"></span>
                </a>

                <a [routerLink]="" class="col-4 p-2 text-center" (click)="editItem($event)">
                    <span class="bi bi-pencil-fill"></span>
                </a>

                <a [routerLink]="" class="col-4 p-2 text-center" (click)="moreInfo($event)">
                    <span class="bi bi-info-circle-fill"></span>
                </a>
            </div>
        </div>
        }

        @if(this.contract.contractStuffs.length>0){
        <div class="row fix-save-button">
            <button class="btn btn-outline-success col-12 ">{{'save'|transloco}}</button>
        </div>
        }

    </div>

    <!-- Modal -->
    <div class="modal fade add-new-item-modal" id="modalId" tabindex="-1" role="dialog" aria-labelledby="modalTitleId"
        aria-hidden="true">
        <div class="modal-dialog modal-sm modal-fullscreen" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" style="text-align: center;width: 100%;" id="modalTitleId">
                        {{"newContractItem"|transloco}}
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>


                <div class="modal-body">

                    <ng-select [items]="stuff$ |async" [typeahead]="inputSearchStuff$" class="text-center center"
                        bindValue="id" bindLabel="name" [notFoundText]="'notFound'|transloco"
                        [placeholder]="'stuff'|transloco" autofocus default [(ngModel)]="contractItem.stuff">

                        <ng-template ng-option-tmp let-item="item" let-index="index">
                            <span class="col-6 p-3 text-start border-1 text-success">{{ item.name}}</span>
                        </ng-template>
                    </ng-select>

                    <div class="col-12">
                        <app-form-input-number [labelName]="'quantity'"
                            (value)="contractItem.quantity=($event)"></app-form-input-number>
                    </div>

                    <div class="col-12">
                        <app-form-input-number [labelName]="'pricePerDay'"
                            (value)="contractItem.pricePerDay=($event)"></app-form-input-number>
                    </div>


                    <div class="col-12">
                        <app-form-input [labelName]="'description'"
                            (value)="contractItem.description=($event)"></app-form-input>
                    </div>
                </div>

                <!-- modal footer -->
                <div class="modal-footer p-4">
                    <div class="col-12">
                        <div class="row">
                            <div class="col-12 col-md-6 p-3">
                                <div>
                                    <button type="button" class="btn btn-outline-primary col-12" (click)="addItem()">
                                        <span class="bi bi-plus-lg"></span>
                                        {{"add" |transloco}}</button>
                                </div>

                            </div>

                            <div class="col-12 col-md-6 p-3">
                                <div>
                                    <button type="button" class="btn btn-outline-primary col-12 ">
                                        <span class="bi bi-plus-lg"></span>
                                        <span class="bi bi-backspace"></span>
                                        {{"addAndClose" |transloco}}
                                    </button>
                                </div>

                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</form>